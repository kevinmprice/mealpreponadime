---
import BaseLayout from '../../layouts/BaseLayout.astro';
import { getCollection } from 'astro:content';

const posts = (await getCollection('blog'))
  .filter(post => !post.data.draft)
  .sort((a, b) => b.data.date.valueOf() - a.data.date.valueOf());
---

<BaseLayout title="Recipes ‚Äî MealPrepOnADime" description="Budget-friendly meal prep recipes with cost breakdowns, shopping lists, and step-by-step instructions.">
  <div class="container">
    <header class="page-header">
      <h1>All Recipes</h1>
      <p>Budget-friendly meal prep recipes with cost breakdowns and shopping lists.</p>
    </header>
    
    <div class="posts-grid">
      {posts.map(post => (
        <article class="post-card">
          <a href={`/blog/${post.slug}`}>
            {post.data.heroImage && (
              <img src={post.data.heroImage} alt={post.data.heroAlt || post.data.title} loading="lazy" />
            )}
            <div class="post-card-content">
              <span class="post-category">{post.data.category}</span>
              {post.data.costPerServing && (
                <span class="cost-badge">${post.data.costPerServing}/serving</span>
              )}
              <h2>{post.data.title}</h2>
              <p>{post.data.excerpt}</p>
              <div class="post-meta">
                {post.data.prepTime && <span>‚è±Ô∏è {post.data.prepTime}</span>}
                {post.data.servings && <span>üçΩÔ∏è {post.data.servings} servings</span>}
              </div>
            </div>
          </a>
        </article>
      ))}
    </div>
    
    {posts.length === 0 && (
      <div class="empty-state">
        <p>üç≥ Recipes coming soon! Check back shortly.</p>
      </div>
    )}
  </div>
</BaseLayout>

<style>
  .page-header {
    text-align: center;
    padding: 3rem 0;
  }
  
  .page-header h1 {
    margin-bottom: 0.5rem;
  }
  
  .page-header p {
    color: var(--color-text-light);
  }
  
  .posts-grid {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(320px, 1fr));
    gap: 2rem;
    padding-bottom: 3rem;
  }
  
  .post-card {
    background: #fff;
    border-radius: 12px;
    overflow: hidden;
    box-shadow: 0 2px 8px rgba(0,0,0,0.06);
    transition: transform 0.2s, box-shadow 0.2s;
  }
  
  .post-card:hover {
    transform: translateY(-4px);
    box-shadow: 0 8px 24px rgba(0,0,0,0.1);
  }
  
  .post-card img {
    width: 100%;
    height: 220px;
    object-fit: cover;
    border-radius: 0;
  }
  
  .post-card-content {
    padding: 1.25rem;
  }
  
  .post-category {
    font-size: 0.75rem;
    text-transform: uppercase;
    letter-spacing: 0.05em;
    color: var(--color-primary);
    font-weight: 600;
  }
  
  .post-card h2 {
    font-size: 1.25rem;
    margin: 0.5rem 0;
  }
  
  .post-card p {
    color: var(--color-text-light);
    font-size: 0.9rem;
    margin-bottom: 0.75rem;
  }
  
  .post-meta {
    display: flex;
    gap: 1rem;
    font-size: 0.8rem;
    color: var(--color-text-light);
  }
  
  .empty-state {
    text-align: center;
    padding: 4rem 0;
    color: var(--color-text-light);
    font-size: 1.25rem;
  }
</style>
